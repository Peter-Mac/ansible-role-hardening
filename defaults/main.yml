---
admin_email: admin@example.org
hardening_admin_email: admin@example.org
hardening_ansible_password: password # password for deployment user
hardening_ansible_user: ansible # this is the deployment user
hardening_install_logwatch: true
logwatch_detail: low # detail for logwatch emails, low|medium|high
hardening_ssh: true
hardening_ssh_settings:
  - key: 'Ciphers'
    value: 'chacha20-poly1305@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr'
    # I am seeing lots of issues with Ansible/Paramiko here :(
    #value: 'chacha20-poly1305@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr'
  - key: 'MACs'
    value: 'hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-ripemd160-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,umac-128@openssh.com,hmac-sha1'
    # I am seeing lots of issues with Ansible/Paramiko here :(
    #value: 'hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-ripemd160-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,umac-128@openssh.com'
  - key: 'KexAlgorithms'
    value: 'curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1'
    # I am seeing lots of issues with Ansible/Paramiko here :(
    #value: 'curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256'
  - key: 'Port'
    value: '22'
  - key: 'PermitRootLogin'
    value: 'no'
  - key: 'PermitEmptyPasswords'
    value: 'no'
  - key: 'IgnoreRhosts'
    value: 'yes'
#  - key: 'PasswordAuthentication'
#    value: 'no'
  - key: 'PubkeyAuthentication'
    value: 'yes'
  - key: 'UsePrivilegeSeparation'
    value: 'yes'
  - key: 'ChallengeResponseAuthentication'
    value: 'no'
  - key: 'X11Forwarding'
    value: 'no'
  - key: 'PrintMotd'
    value: 'no'
hardening_kernel: true
hardening_kernel_settings:
  - key: 'kernel.core_uses_pid'
    value: '1'
  - key: 'kernel.sysrq'
    value: '0'
  - key: 'net.ipv4.icmp_echo_ignore_broadcasts'
    value: '1'
  - key: 'net.ipv4.conf.all.accept_source_route'
    value: '0'
  - key: 'net.ipv4.conf.default.accept_source_route'
    value: '0'
  - key: 'net.ipv6.conf.default.accept_source_route'
    value: '0'
  - key: 'net.ipv4.conf.all.send_redirects'
    value: '0'
  - key: 'net.ipv4.conf.default.send_redirects'
    value: '0'
  - key: 'net.ipv4.tcp_max_syn_backlog'
    value: '2048'
  - key: 'net.ipv4.tcp_synack_retries'
    value: '2'
  - key: 'net.ipv4.tcp_syncookies'
    value: '1'
  - key: 'net.ipv4.tcp_timestamps'
    value: '0'
  - key: 'net.ipv4.tcp_syn_retries'
    value: '5'
  - key: 'net.ipv4.conf.all.log_martians'
    value: '1'
  - key: 'net.ipv4.conf.default.log_martians'
    value: '1'
  - key: 'net.ipv4.icmp_ignore_bogus_error_responses'
    value: '1'
  - key: 'net.ipv4.conf.all.accept_redirects'
    value: '0'
  - key: 'net.ipv6.conf.all.accept_redirects'
    value: '0'
  - key: 'net.ipv4.conf.default.accept_redirects'
    value: '0'
  - key: 'net.ipv6.conf.default.accept_redirects'
    value: '0'
  - key: 'net.ipv4.icmp_echo_ignore_all'
    value: '1'
